<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel = "stylesheet" type = "text/css" href = "css/style.css" />
<title>OM Logs</title>
<script type="text/javascript">

function doSearch() {
  var idText = document.getElementById("inputAdoID").value;
  var data = {"adoID": parseInt(idText)};
  var url = "https://prod-06.westcentralus.logic.azure.com:443/workflows/9706f314a77a43cb99d21b7f98ec29ad/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=VkzbHDQ4RkOIEW_PXK6cP63eyGn2uEM95L7OwaBxixQ";
  //clear old content out
  document.getElementById("gymLinkList").innerText = "";
  fetch(url, {
          method: 'POST',
          headers: {
              'Content-Type': 'application/json',
          },
          body: JSON.stringify(data),
      })
      .then(function (response) { 
        return response.json();
      }).then(function (gymLinks) {
            console.log("got the response from Flow");
            console.log(gymLinks);
            document.getElementById("gymCount").innerText += gymLinks.length;
            console.log(gymLinks.length)

            var ulElement = document.getElementById("gymLinkList");
            for (var i = gymLinks.length - 1; i >= 0; i--) {
              var url = gymLinks[i];
              var itemElement = document.createElement("li");
              var linkElement = document.createElement("a");
              linkElement.href = url;
              linkElement.innerText = url;
              ulElement.appendChild(itemElement);
              itemElement.appendChild(linkElement);
            }
          }
        );
}
</script>
</head>
<body>
    <div id="banner">
        <div id="banner-content">
            OM Log Collector
        </div>
    </div>
    <div id="loader"> 
      <div class="loader">

        ADO Bug Number (e.g. 3354775):
        <br>
        <input type="text" name="adoID" id="inputAdoID" value="">
        <br>
        <input type="button" value="Search" onclick="doSearch()">
        <!-- the output from flow will go here -->
        <div id="notes">
        Things to come: Loading screen when search is clicked.
        <br>
        Note: Depending on the amount of bugs it could take a minute for results to post.
      </div>
      <br>
      <div id="linkcount">
        <p id="gymCount">Total Links:  </p>
      </div>
        <ul id="gymLinkList">
        </ul>
    </div>
</body>
</html>